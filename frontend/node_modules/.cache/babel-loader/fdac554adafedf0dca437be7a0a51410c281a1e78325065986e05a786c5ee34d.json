{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Modal,Form,Alert,Button,Row,Col}from'react-bootstrap';import{X,Plus,Image as ImageIcon}from'lucide-react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CreateProductModal=_ref=>{let{show,onClose,onSubmit}=_ref;const[formData,setFormData]=useState({brand:'',name:'',category:'Flower',description:'',variations:[{amount:'',strain:'',thcContent:'',price:'',salePrice:'',image:null}]});const[errors,setErrors]=useState({});const[imageUrls,setImageUrls]=useState([]);const[availableStrains,setAvailableStrains]=useState([]);const[filteredStrains,setFilteredStrains]=useState([]);const[dropdownVisible,setDropdownVisible]=useState(false);const[activeDropdownIndex,setActiveDropdownIndex]=useState(null);const initialFormState={brand:'',name:'',category:'Flower',description:'',variations:[{amount:'',strain:'',thcContent:'',price:'',salePrice:'',image:null}]};// Fetch available strains\nuseEffect(()=>{const fetchStrains=async()=>{try{const response=await fetch('https://api.weedhurry.com/api/strains',{credentials:'include',headers:{'Accept':'application/json','Content-Type':'application/json'}});if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`);}const data=await response.json();// Assuming the API returns an array of strains directly\n// If it's nested in a data property, use data.data instead\nsetAvailableStrains(data);setFilteredStrains(data);}catch(error){console.error('Error fetching strains:',error);// Set empty arrays to prevent map errors\nsetAvailableStrains([]);setFilteredStrains([]);}};fetchStrains();},[]);const categories=['Flower','Pre-roll','Vape','Edible','Concentrate','Tincture','Gear'];const categoryAmounts={Flower:['3.5g','7g','½oz','1oz'],Vape:['0.3g','0.5g','1g'],'Pre-roll':['1g','1.2g','2.5g','3g','3.5g','4g','5g','7g'],Edible:['5mg','20mg','25mg','50mg','100mg','150mg','200mg','300mg','500mg','1000mg'],Concentrate:['0.5g','1g'],Tincture:['500mg','1000mg'],Gear:[]};const handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>{const newData={...prev,[name]:value};if(name==='category'){newData.variations=prev.variations.map(variation=>({...variation,amount:''}));}return newData;});if(errors[name]){setErrors(prev=>({...prev,[name]:''}));}};const handleVariationChange=(index,field,value)=>{setFormData(prev=>({...prev,variations:prev.variations.map((v,i)=>i===index?{...v,[field]:value}:v)}));if(errors[`variation-${index}-${field}`]){setErrors(prev=>({...prev,[`variation-${index}-${field}`]:''}));}if(field==='strain'&&value.trim()){const filtered=availableStrains.filter(strain=>strain.name.toLowerCase().includes(value.toLowerCase()));setFilteredStrains(filtered);setActiveDropdownIndex(index);setDropdownVisible(true);}};const handleSelectStrain=(index,strain)=>{handleVariationChange(index,'strain',`${strain.name} (${strain.classification.substring(0,3).toUpperCase()})`);setDropdownVisible(false);setActiveDropdownIndex(null);};const handleImageUpload=(index,e)=>{const file=e.target.files[0];if(file){if(file.size>5*1024*1024){alert('File size too large. Please choose an image under 5MB.');return;}if(!file.type.startsWith('image/')){alert('Please upload only image files.');return;}const url=URL.createObjectURL(file);setImageUrls(prev=>{const newUrls=[...prev];newUrls[index]=url;return newUrls;});handleVariationChange(index,'image',file);}};const addVariation=()=>{setFormData(prev=>({...prev,variations:[...prev.variations,{amount:'',strain:'',thcContent:'',price:'',salePrice:'',image:null}]}));};const removeVariation=index=>{setFormData(prev=>({...prev,variations:prev.variations.filter((_,i)=>i!==index)}));setImageUrls(prev=>prev.filter((_,i)=>i!==index));};const reuseImage=(targetIndex,sourceIndex)=>{const sourceImage=formData.variations[sourceIndex].image;const sourceUrl=imageUrls[sourceIndex];setFormData(prev=>({...prev,variations:prev.variations.map((v,i)=>i===targetIndex?{...v,image:sourceImage}:v)}));setImageUrls(prev=>{const newUrls=[...prev];newUrls[targetIndex]=sourceUrl;return newUrls;});};const validateForm=()=>{const newErrors={};if(!formData.brand.trim())newErrors.brand='Brand is required';if(!formData.name.trim())newErrors.name='Product name is required';if(!formData.category)newErrors.category='Category is required';formData.variations.forEach((variation,index)=>{if(!variation.amount&&formData.category!=='Gear'){newErrors[`variation-${index}-amount`]='Amount is required';}if(!variation.strain&&formData.category!=='Gear'){newErrors[`variation-${index}-strain`]='Strain is required';}if(!variation.price||variation.price<=0){newErrors[`variation-${index}-price`]='Valid price is required';}if(variation.salePrice&&Number(variation.salePrice)>=Number(variation.price)){newErrors[`variation-${index}-salePrice`]='Sale price must be less than regular price';}if(!variation.image){newErrors[`variation-${index}-image`]='Image is required';}});setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm())return;try{// Step 1: Create the base product in catalog\nconst productData=new FormData();productData.append('name',formData.name);productData.append('brand',formData.brand);productData.append('category',formData.category);productData.append('description',formData.description);// Get unique amounts for the base product\nconst uniqueAmounts=[...new Set(formData.variations.map(v=>v.amount))];productData.append('amount',JSON.stringify(uniqueAmounts));// Add all variation images to the product catalog\nformData.variations.forEach((variation,index)=>{if(variation.image){productData.append('images',variation.image);}});// Create base product with all images\nconst productResponse=await axios.post('/api/products',productData,{headers:{'Content-Type':'multipart/form-data'},withCredentials:true});// Step 2: Create vendor products for each variation using catalog images\nconst creationPromises=formData.variations.map((variation,index)=>{// Use the corresponding image URL from the product catalog\nconst imageUrl=productResponse.data.images[index];// Create vendor product\nreturn axios.post('/api/vendor-products',{productId:productResponse.data._id,name:formData.name,brand:formData.brand,category:formData.category,description:formData.description,amounts:uniqueAmounts,variation:{amount:variation.amount,strain:variation.strain,thcContent:variation.thcContent||null,price:parseFloat(variation.price),salePrice:variation.salePrice?parseFloat(variation.salePrice):null,image:imageUrl,tags:[]}},{withCredentials:true});});await Promise.all(creationPromises);// Reset form state\nsetFormData(initialFormState);// Reset image URLs\nsetImageUrls([]);// Reset errors\nsetErrors({});// Reset dropdown states\nsetDropdownVisible(false);setActiveDropdownIndex(null);// Close modal\nonClose();}catch(error){console.error('Error creating products:',error);// Show error to user\n}};return/*#__PURE__*/_jsxs(Modal,{show:show,onHide:onClose,size:\"xl\",children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{className:\"fw-bold\",children:\"Add New Product\"})}),/*#__PURE__*/_jsx(Modal.Body,{className:\"max-h-[80vh] overflow-y-auto\",children:/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(Row,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"fw-semibold\",children:\"Brand\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",name:\"brand\",value:formData.brand,onChange:handleInputChange,isInvalid:!!errors.brand}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:errors.brand})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"fw-semibold\",children:\"Category\"}),/*#__PURE__*/_jsx(Form.Select,{name:\"category\",value:formData.category,onChange:handleInputChange,children:categories.map(cat=>/*#__PURE__*/_jsx(\"option\",{value:cat,children:cat},cat))})]})}),/*#__PURE__*/_jsx(Col,{md:12,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"fw-semibold\",children:\"Product Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",name:\"name\",value:formData.name,onChange:handleInputChange,isInvalid:!!errors.name}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:errors.name})]})}),/*#__PURE__*/_jsx(Col,{md:12,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"fw-semibold\",children:\"Description\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",name:\"description\",placeholder:\"Provide brief descriprtion of product-- DO NOT include strain-specific info.\",value:formData.description,onChange:handleInputChange,rows:3})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-top pt-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"mb-4\",children:\"Product Variations\"}),formData.variations.map((variation,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-4 rounded\",style:{backgroundColor:'#f8f9fa'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[\"Variation #\",index+1]}),index>0&&/*#__PURE__*/_jsx(Button,{variant:\"link\",className:\"text-danger p-0\",onClick:()=>removeVariation(index),children:/*#__PURE__*/_jsx(X,{})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"fw-semibold\",children:\"Amount\"}),formData.category!=='Gear'?/*#__PURE__*/_jsxs(Form.Select,{value:variation.amount,onChange:e=>handleVariationChange(index,'amount',e.target.value),isInvalid:!!errors[`variation-${index}-amount`],children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Amount\"}),categoryAmounts[formData.category].map(amount=>/*#__PURE__*/_jsx(\"option\",{value:amount,children:amount},amount))]}):/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:variation.amount,onChange:e=>handleVariationChange(index,'amount',e.target.value),placeholder:\"N/A\",disabled:true}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:errors[`variation-${index}-amount`]})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"fw-semibold\",children:\"Strain / Flavor\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative\",children:[/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:variation.strain,onChange:e=>handleVariationChange(index,'strain',e.target.value),onFocus:()=>{if(variation.strain.trim()){setActiveDropdownIndex(index);setDropdownVisible(true);}},onBlur:()=>setTimeout(()=>{setDropdownVisible(false);setActiveDropdownIndex(null);},200),isInvalid:!!errors[`variation-${index}-strain`]}),index===activeDropdownIndex&&dropdownVisible&&filteredStrains.length>0&&/*#__PURE__*/_jsx(\"ul\",{className:\"dropdown-menu show position-absolute w-100\",style:{zIndex:1000},children:filteredStrains.map((strain,i)=>/*#__PURE__*/_jsxs(\"li\",{className:\"dropdown-item\",style:{cursor:'pointer'},onMouseDown:()=>handleSelectStrain(index,strain),children:[strain.name,\" (\",strain.classification.substring(0,3).toUpperCase(),\")\"]},i))}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:errors[`variation-${index}-strain`]})]})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"fw-semibold\",children:\"Price ($)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",step:\"0.01\",value:variation.price,onChange:e=>handleVariationChange(index,'price',e.target.value),isInvalid:!!errors[`variation-${index}-price`]}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:errors[`variation-${index}-price`]})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"fw-semibold\",children:\"Sale Price ($)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",step:\"0.01\",placeholder:\"Optional\",value:variation.salePrice,onChange:e=>handleVariationChange(index,'salePrice',e.target.value),isInvalid:!!errors[`variation-${index}-salePrice`]}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:errors[`variation-${index}-salePrice`]})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"fw-semibold\",children:\"THC Content (%)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",step:\"0.1\",placeholder:\"Optional\",value:variation.thcContent,onChange:e=>handleVariationChange(index,'thcContent',e.target.value)})]})}),/*#__PURE__*/_jsx(Col,{md:12,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{className:\"fw-semibold\",children:\"Product Image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-wrap gap-3\",children:[imageUrls[index]?/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:imageUrls[index],alt:`Variation ${index+1}`,className:\"rounded\",style:{width:'120px',height:'120px',objectFit:'cover'}}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",size:\"sm\",className:\"position-absolute top-0 end-0 m-1 p-1\",onClick:()=>{setImageUrls(prev=>{const newUrls=[...prev];newUrls[index]=null;return newUrls;});handleVariationChange(index,'image',null);},children:/*#__PURE__*/_jsx(X,{size:14})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>handleImageUpload(index,e),className:\"d-none\",id:`image-upload-${index}`}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:`image-upload-${index}`,className:\"d-flex flex-column align-items-center justify-content-center p-4 border border-2 border-dashed rounded cursor-pointer\",style:{width:'120px',height:'120px',cursor:'pointer'},children:[/*#__PURE__*/_jsx(ImageIcon,{className:\"mb-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"small text-muted\",children:\"Upload Image\"})]})]}),index>0&&imageUrls.some((url,i)=>i<index&&url)&&/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-wrap gap-2\",children:imageUrls.map((url,prevIndex)=>prevIndex<index&&url&&/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative cursor-pointer\",onClick:()=>reuseImage(index,prevIndex),style:{cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"img\",{src:url,alt:`Previous variation ${prevIndex+1}`,className:\"rounded\",style:{width:'120px',height:'120px',objectFit:'cover',opacity:0.7,transition:'opacity 0.2s'},onMouseOver:e=>e.currentTarget.style.opacity='1',onMouseOut:e=>e.currentTarget.style.opacity='0.7'}),/*#__PURE__*/_jsxs(\"div\",{className:\"position-absolute top-0 start-0 m-1 px-2 py-1 bg-dark text-white rounded-pill small\",children:[\"Variation #\",prevIndex+1]})]},prevIndex))})]}),errors[`variation-${index}-image`]&&/*#__PURE__*/_jsx(\"div\",{className:\"text-danger small mt-2\",children:errors[`variation-${index}-image`]})]})]})})]})]},index)),/*#__PURE__*/_jsxs(Button,{variant:\"secondary\",className:\"w-100 mb-4 d-flex align-items-center justify-content-center\",onClick:addVariation,style:{height:'100px'},children:[/*#__PURE__*/_jsx(Plus,{className:\"me-2\"}),\"Add Another Variation\"]})]}),Object.keys(errors).length>0&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",className:\"mt-3\",children:\"Please fix the errors above before submitting.\"})]})}),/*#__PURE__*/_jsxs(Modal.Footer,{className:\"border-top\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onClose,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleSubmit,children:\"Create Product\"})]})]});};export default CreateProductModal;","map":{"version":3,"names":["React","useState","useEffect","Modal","Form","Alert","Button","Row","Col","X","Plus","Image","ImageIcon","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CreateProductModal","_ref","show","onClose","onSubmit","formData","setFormData","brand","name","category","description","variations","amount","strain","thcContent","price","salePrice","image","errors","setErrors","imageUrls","setImageUrls","availableStrains","setAvailableStrains","filteredStrains","setFilteredStrains","dropdownVisible","setDropdownVisible","activeDropdownIndex","setActiveDropdownIndex","initialFormState","fetchStrains","response","fetch","credentials","headers","ok","Error","status","data","json","error","console","categories","categoryAmounts","Flower","Vape","Edible","Concentrate","Tincture","Gear","handleInputChange","e","value","target","prev","newData","map","variation","handleVariationChange","index","field","v","i","trim","filtered","filter","toLowerCase","includes","handleSelectStrain","classification","substring","toUpperCase","handleImageUpload","file","files","size","alert","type","startsWith","url","URL","createObjectURL","newUrls","addVariation","removeVariation","_","reuseImage","targetIndex","sourceIndex","sourceImage","sourceUrl","validateForm","newErrors","forEach","Number","Object","keys","length","handleSubmit","preventDefault","productData","FormData","append","uniqueAmounts","Set","JSON","stringify","productResponse","post","withCredentials","creationPromises","imageUrl","images","productId","_id","amounts","parseFloat","tags","Promise","all","onHide","children","Header","closeButton","Title","className","Body","md","Group","Label","Control","onChange","isInvalid","Feedback","Select","cat","as","placeholder","rows","style","backgroundColor","variant","onClick","disabled","onFocus","onBlur","setTimeout","zIndex","cursor","onMouseDown","step","src","alt","width","height","objectFit","accept","id","htmlFor","some","prevIndex","opacity","transition","onMouseOver","currentTarget","onMouseOut","Footer"],"sources":["/Users/home/Desktop/weedhurry-platform/v1/frontend/src/components/CreateProductModal.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Modal, Form, Alert, Button, Row, Col } from 'react-bootstrap';\nimport { X, Plus, Image as ImageIcon } from 'lucide-react';\nimport axios from 'axios';\n\nconst CreateProductModal = ({ show, onClose, onSubmit }) => {\n  const [formData, setFormData] = useState({\n    brand: '',\n    name: '',\n    category: 'Flower',\n    description: '',\n    variations: [\n      {\n        amount: '',\n        strain: '',\n        thcContent: '',\n        price: '',\n        salePrice: '',\n        image: null\n      }\n    ]\n  });\n  \n  const [errors, setErrors] = useState({});\n  const [imageUrls, setImageUrls] = useState([]);\n  const [availableStrains, setAvailableStrains] = useState([]);\n  const [filteredStrains, setFilteredStrains] = useState([]);\n  const [dropdownVisible, setDropdownVisible] = useState(false);\n  const [activeDropdownIndex, setActiveDropdownIndex] = useState(null);\n\n  const initialFormState = {\n    brand: '',\n    name: '',\n    category: 'Flower',\n    description: '',\n    variations: [\n      {\n        amount: '',\n        strain: '',\n        thcContent: '',\n        price: '',\n        salePrice: '',\n        image: null\n      }\n    ]\n  };\n\n  // Fetch available strains\n  useEffect(() => {\n    const fetchStrains = async () => {\n      try {\n        const response = await fetch('https://api.weedhurry.com/api/strains', {\n          credentials: 'include',\n          headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n          }\n        });\n        \n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        // Assuming the API returns an array of strains directly\n        // If it's nested in a data property, use data.data instead\n        setAvailableStrains(data);\n        setFilteredStrains(data);\n      } catch (error) {\n        console.error('Error fetching strains:', error);\n        // Set empty arrays to prevent map errors\n        setAvailableStrains([]);\n        setFilteredStrains([]);\n      }\n    };\n  \n    fetchStrains();\n  }, []);\n\n  const categories = [\n    'Flower',\n    'Pre-roll',\n    'Vape',\n    'Edible',\n    'Concentrate',\n    'Tincture',\n    'Gear'\n  ];\n\n  const categoryAmounts = {\n    Flower: ['3.5g', '7g', '½oz', '1oz'],\n    Vape: ['0.3g', '0.5g', '1g'],\n    'Pre-roll': ['1g', '1.2g', '2.5g', '3g', '3.5g', '4g', '5g', '7g'],\n    Edible: ['5mg', '20mg', '25mg', '50mg', '100mg', '150mg', '200mg', '300mg', '500mg', '1000mg'],\n    Concentrate: ['0.5g', '1g'],\n    Tincture: ['500mg', '1000mg'],\n    Gear: []\n  };\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData(prev => {\n      const newData = {\n        ...prev,\n        [name]: value\n      };\n  \n      if (name === 'category') {\n        newData.variations = prev.variations.map(variation => ({\n          ...variation,\n          amount: ''\n        }));\n      }\n  \n      return newData;\n    });\n    \n    if (errors[name]) {\n      setErrors(prev => ({\n        ...prev,\n        [name]: ''\n      }));\n    }\n  };\n\n  const handleVariationChange = (index, field, value) => {\n    setFormData(prev => ({\n      ...prev,\n      variations: prev.variations.map((v, i) => \n        i === index ? { ...v, [field]: value } : v\n      )\n    }));\n    \n    if (errors[`variation-${index}-${field}`]) {\n      setErrors(prev => ({\n        ...prev,\n        [`variation-${index}-${field}`]: ''\n      }));\n    }\n\n    if (field === 'strain' && value.trim()) {\n      const filtered = availableStrains.filter(strain =>\n        strain.name.toLowerCase().includes(value.toLowerCase())\n      );\n      setFilteredStrains(filtered);\n      setActiveDropdownIndex(index);\n      setDropdownVisible(true);\n    }\n  };\n\n  const handleSelectStrain = (index, strain) => {\n    handleVariationChange(\n      index,\n      'strain',\n      `${strain.name} (${strain.classification.substring(0, 3).toUpperCase()})`\n    );\n    setDropdownVisible(false);\n    setActiveDropdownIndex(null);\n  };\n\n  const handleImageUpload = (index, e) => {\n    const file = e.target.files[0];\n    if (file) {\n      if (file.size > 5 * 1024 * 1024) {\n        alert('File size too large. Please choose an image under 5MB.');\n        return;\n      }\n      if (!file.type.startsWith('image/')) {\n        alert('Please upload only image files.');\n        return;\n      }\n      const url = URL.createObjectURL(file);\n      setImageUrls(prev => {\n        const newUrls = [...prev];\n        newUrls[index] = url;\n        return newUrls;\n      });\n      handleVariationChange(index, 'image', file);\n    }\n  };\n\n  const addVariation = () => {\n    setFormData(prev => ({\n      ...prev,\n      variations: [...prev.variations, {\n        amount: '',\n        strain: '',\n        thcContent: '',\n        price: '',\n        salePrice: '',\n        image: null\n      }]\n    }));\n  };\n\n  const removeVariation = (index) => {\n    setFormData(prev => ({\n      ...prev,\n      variations: prev.variations.filter((_, i) => i !== index)\n    }));\n    setImageUrls(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const reuseImage = (targetIndex, sourceIndex) => {\n    const sourceImage = formData.variations[sourceIndex].image;\n    const sourceUrl = imageUrls[sourceIndex];\n    \n    setFormData(prev => ({\n      ...prev,\n      variations: prev.variations.map((v, i) => \n        i === targetIndex ? { ...v, image: sourceImage } : v\n      )\n    }));\n    \n    setImageUrls(prev => {\n      const newUrls = [...prev];\n      newUrls[targetIndex] = sourceUrl;\n      return newUrls;\n    });\n  };\n\n  const validateForm = () => {\n    const newErrors = {};\n    \n    if (!formData.brand.trim()) newErrors.brand = 'Brand is required';\n    if (!formData.name.trim()) newErrors.name = 'Product name is required';\n    if (!formData.category) newErrors.category = 'Category is required';\n    \n    formData.variations.forEach((variation, index) => {\n      if (!variation.amount && formData.category !== 'Gear') {\n        newErrors[`variation-${index}-amount`] = 'Amount is required';\n      }\n      if (!variation.strain && formData.category !== 'Gear') {\n        newErrors[`variation-${index}-strain`] = 'Strain is required';\n      }\n      if (!variation.price || variation.price <= 0) {\n        newErrors[`variation-${index}-price`] = 'Valid price is required';\n      }\n      if (variation.salePrice && Number(variation.salePrice) >= Number(variation.price)) {\n        newErrors[`variation-${index}-salePrice`] = 'Sale price must be less than regular price';\n      }\n      if (!variation.image) {\n        newErrors[`variation-${index}-image`] = 'Image is required';\n      }\n    });\n  \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!validateForm()) return;\n\n    try {\n        // Step 1: Create the base product in catalog\n        const productData = new FormData();\n        productData.append('name', formData.name);\n        productData.append('brand', formData.brand);\n        productData.append('category', formData.category);\n        productData.append('description', formData.description);\n        \n        // Get unique amounts for the base product\n        const uniqueAmounts = [...new Set(formData.variations.map(v => v.amount))];\n        productData.append('amount', JSON.stringify(uniqueAmounts));\n\n        // Add all variation images to the product catalog\n        formData.variations.forEach((variation, index) => {\n            if (variation.image) {\n                productData.append('images', variation.image);\n            }\n        });\n\n        // Create base product with all images\n        const productResponse = await axios.post('/api/products', productData, {\n            headers: { 'Content-Type': 'multipart/form-data' },\n            withCredentials: true\n        });\n\n        // Step 2: Create vendor products for each variation using catalog images\n        const creationPromises = formData.variations.map((variation, index) => {\n            // Use the corresponding image URL from the product catalog\n            const imageUrl = productResponse.data.images[index];\n\n            // Create vendor product\n            return axios.post('/api/vendor-products', {\n                productId: productResponse.data._id,\n                name: formData.name,\n                brand: formData.brand,\n                category: formData.category,\n                description: formData.description,\n                amounts: uniqueAmounts,\n                variation: {\n                    amount: variation.amount,\n                    strain: variation.strain,\n                    thcContent: variation.thcContent || null,\n                    price: parseFloat(variation.price),\n                    salePrice: variation.salePrice ? parseFloat(variation.salePrice) : null,\n                    image: imageUrl,\n                    tags: []\n                }\n            }, {\n                withCredentials: true\n            });\n        });\n\n        await Promise.all(creationPromises);\n\n        // Reset form state\n        setFormData(initialFormState);\n        // Reset image URLs\n        setImageUrls([]);\n        // Reset errors\n        setErrors({});\n        // Reset dropdown states\n        setDropdownVisible(false);\n        setActiveDropdownIndex(null);\n        // Close modal\n        onClose();\n    } catch (error) {\n        console.error('Error creating products:', error);\n        // Show error to user\n    }\n};\n\n  return (\n    <Modal show={show} onHide={onClose} size=\"xl\">\n      <Modal.Header closeButton>\n        <Modal.Title className=\"fw-bold\">Add New Product</Modal.Title>\n      </Modal.Header>\n      \n      <Modal.Body className=\"max-h-[80vh] overflow-y-auto\">\n        <Form onSubmit={handleSubmit}>\n          <Row className=\"mb-4\">\n            <Col md={6}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label className=\"fw-semibold\">Brand</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"brand\"\n                  value={formData.brand}\n                  onChange={handleInputChange}\n                  isInvalid={!!errors.brand}\n                />\n                <Form.Control.Feedback type=\"invalid\">\n                  {errors.brand}\n                </Form.Control.Feedback>\n              </Form.Group>\n            </Col>\n\n            <Col md={6}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label className=\"fw-semibold\">Category</Form.Label>\n                <Form.Select\n                  name=\"category\"\n                  value={formData.category}\n                  onChange={handleInputChange}\n                >\n                  {categories.map(cat => (\n                    <option key={cat} value={cat}>{cat}</option>\n                  ))}\n                </Form.Select>\n              </Form.Group>\n            </Col>\n\n            <Col md={12}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label className=\"fw-semibold\">Product Name</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"name\"\n                  value={formData.name}\n                  onChange={handleInputChange}\n                  isInvalid={!!errors.name}\n                />\n                <Form.Control.Feedback type=\"invalid\">\n                  {errors.name}\n                </Form.Control.Feedback>\n              </Form.Group>\n            </Col>\n\n\n            <Col md={12}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label className=\"fw-semibold\">Description</Form.Label>\n                <Form.Control\n                  as=\"textarea\"\n                  name=\"description\"\n                  placeholder=\"Provide brief descriprtion of product-- DO NOT include strain-specific info.\"\n                  value={formData.description}\n                  onChange={handleInputChange}\n                  rows={3}\n                />\n              </Form.Group>\n            </Col>\n          </Row>\n\n          <div className=\"border-top pt-4\">\n            <h4 className=\"mb-4\">Product Variations</h4>\n            {formData.variations.map((variation, index) => (\n              <div\n                key={index}\n                className=\"mb-4 p-4 rounded\"\n                style={{ backgroundColor: '#f8f9fa' }}\n              >\n                <div className=\"d-flex justify-content-between align-items-center mb-3\">\n                  <h5 className=\"mb-0\">Variation #{index + 1}</h5>\n                  {index > 0 && (\n                    <Button\n                      variant=\"link\"\n                      className=\"text-danger p-0\"\n                      onClick={() => removeVariation(index)}\n                    >\n                      <X />\n                    </Button>\n                  )}\n                </div>\n\n                <Row>\n                  <Col md={6}>\n                    <Form.Group className=\"mb-3\">\n                      <Form.Label className=\"fw-semibold\">Amount</Form.Label>\n                      {formData.category !== 'Gear' ? (\n                        <Form.Select\n                          value={variation.amount}\n                          onChange={(e) => handleVariationChange(index, 'amount', e.target.value)}\n                          isInvalid={!!errors[`variation-${index}-amount`]}\n                        >\n                          <option value=\"\">Select Amount</option>\n                          {categoryAmounts[formData.category].map((amount) => (\n                            <option key={amount} value={amount}>\n                              {amount}\n                            </option>\n                          ))}\n                        </Form.Select>\n                      ) : (\n                        <Form.Control\n                          type=\"text\"\n                          value={variation.amount}\n                          onChange={(e) => handleVariationChange(index, 'amount', e.target.value)}\n                          placeholder=\"N/A\"\n                          disabled\n                        />\n                      )}\n                      <Form.Control.Feedback type=\"invalid\">\n                        {errors[`variation-${index}-amount`]}\n                      </Form.Control.Feedback>\n                    </Form.Group>\n                  </Col>\n\n                  <Col md={6}>\n                    <Form.Group className=\"mb-3\">\n                      <Form.Label className=\"fw-semibold\">Strain / Flavor</Form.Label>\n                      <div className=\"position-relative\">\n                        <Form.Control\n                          type=\"text\"\n                          value={variation.strain}\n                          onChange={(e) => handleVariationChange(index, 'strain', e.target.value)}\n                          onFocus={() => {\n                            if (variation.strain.trim()) {\n                              setActiveDropdownIndex(index);\n                              setDropdownVisible(true);\n                            }\n                          }}\n                          onBlur={() => setTimeout(() => {\n                            setDropdownVisible(false);\n                            setActiveDropdownIndex(null);\n                          }, 200)}\n                          isInvalid={!!errors[`variation-${index}-strain`]}\n                        />\n                        {index === activeDropdownIndex && dropdownVisible && filteredStrains.length > 0 && (\n                          <ul \n                            className=\"dropdown-menu show position-absolute w-100\" \n                            style={{ zIndex: 1000 }}\n                          >\n                            {filteredStrains.map((strain, i) => (\n                              <li\n                                key={i}\n                                className=\"dropdown-item\"\n                                style={{ cursor: 'pointer' }}\n                                onMouseDown={() => handleSelectStrain(index, strain)}\n                              >\n                                {strain.name} ({strain.classification.substring(0, 3).toUpperCase()})\n                              </li>\n                            ))}\n                          </ul>\n                        )}\n                        <Form.Control.Feedback type=\"invalid\">\n                          {errors[`variation-${index}-strain`]}\n                        </Form.Control.Feedback>\n                      </div>\n                    </Form.Group>\n                  </Col>\n\n\n                  <Col md={4}>\n                    <Form.Group className=\"mb-3\">\n                      <Form.Label className=\"fw-semibold\">Price ($)</Form.Label>\n                      <Form.Control\n                        type=\"number\"\n                        step=\"0.01\"\n                        value={variation.price}\n                        onChange={(e) => handleVariationChange(index, 'price', e.target.value)}\n                        isInvalid={!!errors[`variation-${index}-price`]}\n                      />\n                      <Form.Control.Feedback type=\"invalid\">\n                        {errors[`variation-${index}-price`]}\n                      </Form.Control.Feedback>\n                    </Form.Group>\n                  </Col>\n\n                  <Col md={4}>\n                    <Form.Group className=\"mb-3\">\n                      <Form.Label className=\"fw-semibold\">Sale Price ($)</Form.Label>\n                      <Form.Control\n                        type=\"number\"\n                        step=\"0.01\"\n                        placeholder=\"Optional\"\n                        value={variation.salePrice}\n                        onChange={(e) => handleVariationChange(index, 'salePrice', e.target.value)}\n                        isInvalid={!!errors[`variation-${index}-salePrice`]}\n                      />\n                      <Form.Control.Feedback type=\"invalid\">\n                        {errors[`variation-${index}-salePrice`]}\n                      </Form.Control.Feedback>\n                    </Form.Group>\n                  </Col>\n\n                  <Col md={4}>\n                    <Form.Group className=\"mb-3\">\n                      <Form.Label className=\"fw-semibold\">THC Content (%)</Form.Label>\n                      <Form.Control\n                        type=\"number\"\n                        step=\"0.1\"\n                        placeholder=\"Optional\"\n                        value={variation.thcContent}\n                        onChange={(e) => handleVariationChange(index, 'thcContent', e.target.value)}\n                      />\n                    </Form.Group>\n                  </Col>\n\n                  <Col md={12}>\n                    <Form.Group className=\"mb-3\">\n                      <Form.Label className=\"fw-semibold\">Product Image</Form.Label>\n                      <div className=\"d-flex flex-wrap gap-3\">\n                        {imageUrls[index] ? (\n                          <div className=\"position-relative\">\n                            <img\n                              src={imageUrls[index]}\n                              alt={`Variation ${index + 1}`}\n                              className=\"rounded\"\n                              style={{ width: '120px', height: '120px', objectFit: 'cover' }}\n                            />\n                            <Button\n                              variant=\"danger\"\n                              size=\"sm\"\n                              className=\"position-absolute top-0 end-0 m-1 p-1\"\n                              onClick={() => {\n                                setImageUrls(prev => {\n                                  const newUrls = [...prev];\n                                  newUrls[index] = null;\n                                  return newUrls;\n                                });\n                                handleVariationChange(index, 'image', null);\n                              }}\n                            >\n                              <X size={14} />\n                            </Button>\n                          </div>\n                        ) : (\n                          <>\n                            <div>\n                              <input\n                                type=\"file\"\n                                accept=\"image/*\"\n                                onChange={(e) => handleImageUpload(index, e)}\n                                className=\"d-none\"\n                                id={`image-upload-${index}`}\n                              />\n                              <label\n                                htmlFor={`image-upload-${index}`}\n                                className=\"d-flex flex-column align-items-center justify-content-center p-4 border border-2 border-dashed rounded cursor-pointer\"\n                                style={{ width: '120px', height: '120px', cursor: 'pointer' }}\n                              >\n                                <ImageIcon className=\"mb-2\" />\n                                <span className=\"small text-muted\">Upload Image</span>\n                              </label>\n                            </div>\n\n                            {/* Previously Used Images */}\n                            {index > 0 && imageUrls.some((url, i) => i < index && url) && (\n                              <div className=\"d-flex flex-wrap gap-2\">\n                                {imageUrls.map((url, prevIndex) => (\n                                  prevIndex < index && url && (\n                                    <div \n                                      key={prevIndex}\n                                      className=\"position-relative cursor-pointer\"\n                                      onClick={() => reuseImage(index, prevIndex)}\n                                      style={{ cursor: 'pointer' }}\n                                    >\n                                      <img\n                                        src={url}\n                                        alt={`Previous variation ${prevIndex + 1}`}\n                                        className=\"rounded\"\n                                        style={{\n                                          width: '120px',\n                                          height: '120px',\n                                          objectFit: 'cover',\n                                          opacity: 0.7,\n                                          transition: 'opacity 0.2s'\n                                        }}\n                                        onMouseOver={(e) => e.currentTarget.style.opacity = '1'}\n                                        onMouseOut={(e) => e.currentTarget.style.opacity = '0.7'}\n                                      />\n                                      <div className=\"position-absolute top-0 start-0 m-1 px-2 py-1 bg-dark text-white rounded-pill small\">\n                                        Variation #{prevIndex + 1}\n                                      </div>\n                                    </div>\n                                  )\n                                ))}\n                              </div>\n                            )}\n                          </>\n                        )}\n                        \n                        {errors[`variation-${index}-image`] && (\n                          <div className=\"text-danger small mt-2\">\n                            {errors[`variation-${index}-image`]}\n                          </div>\n                        )}\n                      </div>\n                    </Form.Group>\n                  </Col>\n                </Row>\n              </div>\n            ))}\n\n            <Button\n              variant=\"secondary\"\n              className=\"w-100 mb-4 d-flex align-items-center justify-content-center\"\n              onClick={addVariation}\n              style={{ height: '100px' }}\n            >\n              <Plus className=\"me-2\" />\n              Add Another Variation\n            </Button>\n          </div>\n\n          {Object.keys(errors).length > 0 && (\n            <Alert variant=\"danger\" className=\"mt-3\">\n              Please fix the errors above before submitting.\n            </Alert>\n          )}\n        </Form>\n      </Modal.Body>\n\n      <Modal.Footer className=\"border-top\">\n        <Button variant=\"secondary\" onClick={onClose}>\n          Cancel\n        </Button>\n        <Button variant=\"primary\" onClick={handleSubmit}>\n          Create Product\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  );\n};\n\nexport default CreateProductModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}