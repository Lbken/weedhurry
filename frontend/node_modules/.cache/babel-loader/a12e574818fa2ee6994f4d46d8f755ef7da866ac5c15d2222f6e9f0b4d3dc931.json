{"ast":null,"code":"// coordinateUtils.js\nexport const processCoordinates=coordinates=>{if(!coordinates||!Array.isArray(coordinates)){console.warn('Invalid coordinates format:',coordinates);return null;}return coordinates.map(coord=>{if(typeof coord==='object'){// Handle MongoDB extended JSON format\nif(coord.$numberDouble!==undefined){return parseFloat(coord.$numberDouble);}if(coord.$numberInt!==undefined){return parseFloat(coord.$numberInt);}}return parseFloat(coord);});};export const enrichVendor=(vendor,userLat,userLng)=>{var _vendor$storefrontAdd,_vendor$deliveryZone;let coordinates=null;let source=null;// Try storefront first for Pickup & Delivery vendors\nif((_vendor$storefrontAdd=vendor.storefrontAddress)!==null&&_vendor$storefrontAdd!==void 0&&_vendor$storefrontAdd.coordinates){coordinates=processCoordinates(vendor.storefrontAddress.coordinates);source='storefront';}// Fall back to delivery zone if needed\nif(!coordinates&&(_vendor$deliveryZone=vendor.deliveryZone)!==null&&_vendor$deliveryZone!==void 0&&_vendor$deliveryZone.coordinates){coordinates=processCoordinates(vendor.deliveryZone.coordinates);source='delivery';}if(!coordinates||coordinates.length!==2){console.warn(`Invalid coordinates for vendor ${vendor.dispensaryName}`);return null;}const[vLng,vLat]=coordinates;// Calculate distance\nconst R=3963;// Earth's radius in miles\nconst dLat=(vLat-userLat)*Math.PI/180;const dLng=(vLng-userLng)*Math.PI/180;const a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(userLat*Math.PI/180)*Math.cos(vLat*Math.PI/180)*Math.sin(dLng/2)*Math.sin(dLng/2);const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));const distance=R*c;return{...vendor,coordinates:[vLng,vLat],coordinateSource:source,milesAway:parseFloat(distance.toFixed(1))};};","map":{"version":3,"names":["processCoordinates","coordinates","Array","isArray","console","warn","map","coord","$numberDouble","undefined","parseFloat","$numberInt","enrichVendor","vendor","userLat","userLng","_vendor$storefrontAdd","_vendor$deliveryZone","source","storefrontAddress","deliveryZone","length","dispensaryName","vLng","vLat","R","dLat","Math","PI","dLng","a","sin","cos","c","atan2","sqrt","distance","coordinateSource","milesAway","toFixed"],"sources":["/Users/home/Desktop/weedhurry-platform/v1/frontend/src/utils/coordinateUtils.js"],"sourcesContent":["// coordinateUtils.js\n\nexport const processCoordinates = (coordinates) => {\n    if (!coordinates || !Array.isArray(coordinates)) {\n      console.warn('Invalid coordinates format:', coordinates);\n      return null;\n    }\n  \n    return coordinates.map(coord => {\n      if (typeof coord === 'object') {\n        // Handle MongoDB extended JSON format\n        if (coord.$numberDouble !== undefined) {\n          return parseFloat(coord.$numberDouble);\n        }\n        if (coord.$numberInt !== undefined) {\n          return parseFloat(coord.$numberInt);\n        }\n      }\n      return parseFloat(coord);\n    });\n  };\n  \n  export const enrichVendor = (vendor, userLat, userLng) => {\n    let coordinates = null;\n    let source = null;\n  \n    // Try storefront first for Pickup & Delivery vendors\n    if (vendor.storefrontAddress?.coordinates) {\n      coordinates = processCoordinates(vendor.storefrontAddress.coordinates);\n      source = 'storefront';\n    }\n    \n    // Fall back to delivery zone if needed\n    if (!coordinates && vendor.deliveryZone?.coordinates) {\n      coordinates = processCoordinates(vendor.deliveryZone.coordinates);\n      source = 'delivery';\n    }\n  \n    if (!coordinates || coordinates.length !== 2) {\n      console.warn(`Invalid coordinates for vendor ${vendor.dispensaryName}`);\n      return null;\n    }\n  \n    const [vLng, vLat] = coordinates;\n  \n    // Calculate distance\n    const R = 3963; // Earth's radius in miles\n    const dLat = (vLat - userLat) * Math.PI / 180;\n    const dLng = (vLng - userLng) * Math.PI / 180;\n    const a = \n      Math.sin(dLat/2) * Math.sin(dLat/2) +\n      Math.cos(userLat * Math.PI / 180) * Math.cos(vLat * Math.PI / 180) * \n      Math.sin(dLng/2) * Math.sin(dLng/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n    const distance = R * c;\n  \n    return {\n      ...vendor,\n      coordinates: [vLng, vLat],\n      coordinateSource: source,\n      milesAway: parseFloat(distance.toFixed(1))\n    };\n  };"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}