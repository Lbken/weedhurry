{"ast":null,"code":"// coordinateUtils.js\n\nexport const processCoordinates = coordinates => {\n  if (!coordinates || !Array.isArray(coordinates)) {\n    console.warn('Invalid coordinates format:', coordinates);\n    return null;\n  }\n  return coordinates.map(coord => {\n    if (typeof coord === 'object') {\n      // Handle MongoDB extended JSON format\n      if (coord.$numberDouble !== undefined) {\n        return parseFloat(coord.$numberDouble);\n      }\n      if (coord.$numberInt !== undefined) {\n        return parseFloat(coord.$numberInt);\n      }\n    }\n    return parseFloat(coord);\n  });\n};\nexport const enrichVendor = (vendor, userLat, userLng) => {\n  var _vendor$storefrontAdd, _vendor$deliveryZone;\n  let coordinates = null;\n  let source = null;\n\n  // Try storefront first for Pickup & Delivery vendors\n  if ((_vendor$storefrontAdd = vendor.storefrontAddress) !== null && _vendor$storefrontAdd !== void 0 && _vendor$storefrontAdd.coordinates) {\n    coordinates = processCoordinates(vendor.storefrontAddress.coordinates);\n    source = 'storefront';\n  }\n\n  // Fall back to delivery zone if needed\n  if (!coordinates && (_vendor$deliveryZone = vendor.deliveryZone) !== null && _vendor$deliveryZone !== void 0 && _vendor$deliveryZone.coordinates) {\n    coordinates = processCoordinates(vendor.deliveryZone.coordinates);\n    source = 'delivery';\n  }\n  if (!coordinates || coordinates.length !== 2) {\n    console.warn(`Invalid coordinates for vendor ${vendor.dispensaryName}`);\n    return null;\n  }\n  const [vLng, vLat] = coordinates;\n\n  // Calculate distance\n  const R = 3963; // Earth's radius in miles\n  const dLat = (vLat - userLat) * Math.PI / 180;\n  const dLng = (vLng - userLng) * Math.PI / 180;\n  const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(userLat * Math.PI / 180) * Math.cos(vLat * Math.PI / 180) * Math.sin(dLng / 2) * Math.sin(dLng / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  const distance = R * c;\n  return {\n    ...vendor,\n    coordinates: [vLng, vLat],\n    coordinateSource: source,\n    milesAway: parseFloat(distance.toFixed(1))\n  };\n};","map":{"version":3,"names":["processCoordinates","coordinates","Array","isArray","console","warn","map","coord","$numberDouble","undefined","parseFloat","$numberInt","enrichVendor","vendor","userLat","userLng","_vendor$storefrontAdd","_vendor$deliveryZone","source","storefrontAddress","deliveryZone","length","dispensaryName","vLng","vLat","R","dLat","Math","PI","dLng","a","sin","cos","c","atan2","sqrt","distance","coordinateSource","milesAway","toFixed"],"sources":["/Users/home/Desktop/weedhurry-platform/v1/frontend/src/utils/coordinateUtils.js"],"sourcesContent":["// coordinateUtils.js\n\nexport const processCoordinates = (coordinates) => {\n    if (!coordinates || !Array.isArray(coordinates)) {\n      console.warn('Invalid coordinates format:', coordinates);\n      return null;\n    }\n  \n    return coordinates.map(coord => {\n      if (typeof coord === 'object') {\n        // Handle MongoDB extended JSON format\n        if (coord.$numberDouble !== undefined) {\n          return parseFloat(coord.$numberDouble);\n        }\n        if (coord.$numberInt !== undefined) {\n          return parseFloat(coord.$numberInt);\n        }\n      }\n      return parseFloat(coord);\n    });\n  };\n  \n  export const enrichVendor = (vendor, userLat, userLng) => {\n    let coordinates = null;\n    let source = null;\n  \n    // Try storefront first for Pickup & Delivery vendors\n    if (vendor.storefrontAddress?.coordinates) {\n      coordinates = processCoordinates(vendor.storefrontAddress.coordinates);\n      source = 'storefront';\n    }\n    \n    // Fall back to delivery zone if needed\n    if (!coordinates && vendor.deliveryZone?.coordinates) {\n      coordinates = processCoordinates(vendor.deliveryZone.coordinates);\n      source = 'delivery';\n    }\n  \n    if (!coordinates || coordinates.length !== 2) {\n      console.warn(`Invalid coordinates for vendor ${vendor.dispensaryName}`);\n      return null;\n    }\n  \n    const [vLng, vLat] = coordinates;\n  \n    // Calculate distance\n    const R = 3963; // Earth's radius in miles\n    const dLat = (vLat - userLat) * Math.PI / 180;\n    const dLng = (vLng - userLng) * Math.PI / 180;\n    const a = \n      Math.sin(dLat/2) * Math.sin(dLat/2) +\n      Math.cos(userLat * Math.PI / 180) * Math.cos(vLat * Math.PI / 180) * \n      Math.sin(dLng/2) * Math.sin(dLng/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n    const distance = R * c;\n  \n    return {\n      ...vendor,\n      coordinates: [vLng, vLat],\n      coordinateSource: source,\n      milesAway: parseFloat(distance.toFixed(1))\n    };\n  };"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}